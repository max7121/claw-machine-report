# ğŸ”§ HTTP é€£ç·šæ•…éšœæ’é™¤ - å¿«é€Ÿæª¢æŸ¥æ¸…å–®

## âš¡ å¿«é€Ÿè¨ºæ–·ï¼ˆ5 åˆ†é˜ï¼‰

### ç¬¬ä¸€æ­¥ï¼šç¢ºèªç¶²è·¯é€£æ¥
```
âœ… èƒ½è¨ªå•å…¶ä»–ç¶²ç«™å—ï¼Ÿï¼ˆå¦‚ Googleï¼‰
âœ… WiFi/æœ‰ç·šé€£æ¥æ­£å¸¸å—ï¼Ÿ
```

### ç¬¬äºŒæ­¥ï¼šé‹è¡Œè‡ªå‹•è¨ºæ–·
1. æŒ‰ **F12** æ‰“é–‹é–‹ç™¼è€…å·¥å…·
2. åˆ‡æ›åˆ° **Console** é¸é …å¡
3. è¤‡è£½ç²˜è²¼ä¸¦é‹è¡Œï¼š
```javascript
diagnoseHttpConnection()
```

### ç¬¬ä¸‰æ­¥ï¼šæŸ¥çœ‹è¨ºæ–·çµæœ
æ ¹æ“šè¨ºæ–·å ±å‘Šä¸­çš„ âœ… æˆ– âŒ ç¢ºå®šå•é¡Œï¼š

```
âœ… ç›´æ¥è«‹æ±‚æˆåŠŸï¼Ÿ    â†’ å·²ä¿®å¾©ï¼Œå•é¡Œå·²è§£æ±º
âŒ ç›´æ¥è«‹æ±‚å¤±æ•—      â†’ é€²å…¥ã€è©³ç´°è¨ºæ–·ã€‘
âŒ ä»£ç†ä¹Ÿå¤±æ•—        â†’ ç¶²è·¯æˆ–ä¼ºæœå™¨å•é¡Œ
```

---

## ğŸ” è©³ç´°è¨ºæ–·ï¼ˆæŒ‰é †åºæª¢æŸ¥ï¼‰

### æª¢æŸ¥ 1ï¼šç¶²è·¯é€£æ¥
```javascript
// åœ¨ Console ä¸­é‹è¡Œ
fetch('https://www.google.com', {mode: 'no-cors'})
  .then(() => console.log('âœ… ç¶²è·¯æ­£å¸¸'))
  .catch(e => console.log('âŒ ç¶²è·¯å•é¡Œ:', e.message))
```

**çµæœ**ï¼š
- âœ… ç¶²è·¯æ­£å¸¸ â†’ é€²å…¥æª¢æŸ¥ 2
- âŒ ç¶²è·¯å•é¡Œ â†’ é‡æ–°é€£æ¥ç¶²è·¯æˆ–é‡å•Ÿè·¯ç”±å™¨

---

### æª¢æŸ¥ 2ï¼šç›®æ¨™ä¼ºæœå™¨å¯é”æ€§
```javascript
// æŸ¥çœ‹ç›®æ¨™ URL
console.log(buildHttpUrl())
```

**åœ¨æ–°åˆ†é ä¸­è¨ªå•é€™å€‹ URL**

**çµæœ**ï¼š
- âœ… å¯ä»¥æ‰“é–‹ä¸”æœ‰æ•¸æ“š â†’ å•é¡Œåœ¨ä»£ç†é…ç½®ï¼Œé€²å…¥æª¢æŸ¥ 3
- âŒ ç„¡æ³•æ‰“é–‹ / ç„¡éŸ¿æ‡‰ â†’ ä¼ºæœå™¨é›¢ç·šï¼Œè¯ç¹«ç®¡ç†å“¡

---

### æª¢æŸ¥ 3ï¼šDNS è§£æ
```javascript
// åœ¨ Console ä¸­é‹è¡Œ
console.log('ç›®æ¨™åŸŸå: update.feiloli.com.tw')
console.log('å˜—è©¦è§£æ...')
fetch('http://update.feiloli.com.tw:5539/textselectdata/test', {mode: 'no-cors'})
  .catch(e => {
    if (e.message.includes('ERR_NAME_NOT_RESOLVED')) {
      console.log('âŒ DNS ç„¡æ³•è§£æï¼Œå˜—è©¦åˆ‡æ› DNS')
    }
  })
```

**çµæœ**ï¼š
- âœ… å¯ä»¥è§£æ â†’ é€²å…¥æª¢æŸ¥ 4
- âŒ ERR_NAME_NOT_RESOLVED â†’ åŸ·è¡Œã€DNS ä¿®å¾©ã€‘

---

### æª¢æŸ¥ 4ï¼šCORS ç­–ç•¥
```javascript
// é©—è­‰ä»£ç†æ˜¯å¦å·¥ä½œ
fetch('https://api.allorigins.win/get?url=http://example.com')
  .then(r => r.json())
  .then(d => console.log('âœ… ä»£ç†æœå‹™æ­£å¸¸'))
  .catch(e => console.log('âŒ ä»£ç†æœå‹™ç•°å¸¸:', e.message))
```

**çµæœ**ï¼š
- âœ… ä»£ç†æ­£å¸¸ â†’ å•é¡Œå¯èƒ½åœ¨ç›®æ¨™ä¼ºæœå™¨
- âŒ ä»£ç†ç•°å¸¸ â†’ ç¶²è·¯å•é¡Œï¼Œé‡è©¦æˆ–åˆ‡æ›ç¶²è·¯

---

## ğŸ› ï¸ å¿«é€Ÿä¿®å¾©

### ä¿®å¾© 1ï¼šåˆ·æ–°é é¢
```
æŒ‰ Ctrl + F5ï¼ˆç¡¬åˆ·æ–°ï¼‰æˆ– Cmd + Shift + R
```
- æ¸…é™¤ç·©å­˜é‡æ–°åŠ è¼‰

---

### ä¿®å¾© 2ï¼šåˆ‡æ› DNSï¼ˆ5 åˆ†é˜ï¼‰

#### Windows ç”¨æˆ¶
1. å³éµé»æ“Šã€Œç¶²è·¯ã€â†’ã€Œå±¬æ€§ã€
2. æ‰¾åˆ°ç•¶å‰ç¶²è·¯â†’ã€Œè®Šæ›´é©é…å™¨é¸é …ã€
3. å³éµé»æ“Šç¶²è·¯é€£æ¥â†’ã€Œå±¬æ€§ã€
4. é›™æ“Šã€Œç¶²éš›ç¶²è·¯é€šè¨Šå”å®š (TCP/IPv4)ã€
5. é¸æ“‡ã€Œä½¿ç”¨ä¸‹åˆ— DNS ä¼ºæœå™¨ä½å€ã€
6. è¼¸å…¥ï¼š
   - é¦–é¸ï¼š`8.8.8.8`
   - å‚™ç”¨ï¼š`8.8.4.4`
7. ç¢ºå®šâ†’é‡å•Ÿç€è¦½å™¨

#### Mac ç”¨æˆ¶
1. ç³»çµ±åå¥½è¨­å®š â†’ ç¶²è·¯
2. é¸æ“‡é€£æ¥ â†’ é€²éš
3. DNS é¸é …å¡
4. é»æ“Š + è™Ÿæ·»åŠ ï¼š
   - `8.8.8.8`
   - `8.8.4.4`
5. ç¢ºå®š

#### Linux ç”¨æˆ¶
ç·¨è¼¯ `/etc/resolv.conf`ï¼š
```bash
sudo nano /etc/resolv.conf
```
æ·»åŠ ï¼š
```
nameserver 8.8.8.8
nameserver 8.8.4.4
```

---

### ä¿®å¾© 3ï¼šå˜—è©¦ä½¿ç”¨ VPN
- å•Ÿç”¨ VPN æˆ–ä»£ç†
- å¯ä»¥ç¹éåœ°å€é™åˆ¶

---

### ä¿®å¾© 4ï¼šä½¿ç”¨æœ¬åœ°ä»£ç†ä¼ºæœå™¨

**å¿«é€Ÿè¨­ç½®ï¼ˆéœ€è¦ Node.jsï¼‰**ï¼š

1. åœ¨æ¡Œé¢å‰µå»ºæ–‡ä»¶ `proxy.js`ï¼š
```javascript
const http = require('http');
const PORT = 3000;
const server = http.createServer((req, res) => {
  res.setHeader('Access-Control-Allow-Origin', '*');
  res.setHeader('Access-Control-Allow-Methods', 'GET');
  if (req.url.includes('/textselectdata')) {
    res.end('{"status":"ok"}');
  }
});
server.listen(PORT);
console.log('ä»£ç†é‹è¡Œåœ¨ localhost:3000');
```

2. é‹è¡Œï¼š
```bash
node proxy.js
```

3. åœ¨ä»£ç¢¼ä¸­ä¿®æ”¹ï¼ˆç¬¬ ~1475 è¡Œï¼‰ï¼š
```javascript
baseUrl: 'http://localhost:3000'
```

---

## ğŸ“Š ç‹€æ…‹æª¢æŸ¥è¡¨

å®Œæˆä»¥ä¸‹æª¢æŸ¥ï¼Œæ¨™è¨˜çµæœï¼š

```
[ ] ç¶²è·¯å¯ä»¥è¨ªå•å…¶ä»–ç¶²ç«™
[ ] diagnoseHttpConnection() é¡¯ç¤ºè©³ç´°ä¿¡æ¯
[ ] å¯ä»¥ç›´æ¥åœ¨ç€è¦½å™¨è¨ªå•ç›®æ¨™ URL
[ ] DNS å¯ä»¥è§£æ update.feiloli.com.tw
[ ] ä»£ç†æœå‹™ (AllOrigins) æ­£å¸¸å·¥ä½œ
[ ] æ²’æœ‰ ERR_NAME_NOT_RESOLVED éŒ¯èª¤
[ ] æ²’æœ‰ CORS éŒ¯èª¤
[ ] æ•¸æ“šæˆåŠŸè¿”å›
```

å…¨éƒ¨æ‰“å‹¾ âœ… = å•é¡Œå·²è§£æ±º

---

## ğŸ†˜ å¦‚æœä»¥ä¸Šéƒ½ä¸è¡Œ

è«‹æ”¶é›†ä»¥ä¸‹ä¿¡æ¯ä¸¦è¯ç¹«æ”¯æŒï¼š

1. **è¨ºæ–·å ±å‘Š**ï¼š
```javascript
// è¤‡è£½ä»¥ä¸‹å‘½ä»¤çš„å…¨éƒ¨è¼¸å‡º
console.log('=== è¨ºæ–·å ±å‘Š ===')
console.log('ç€è¦½å™¨:', navigator.userAgent)
console.log('é é¢ URL:', window.location.href)
diagnoseHttpConnection()
```

2. **éŒ¯èª¤æˆªåœ–**ï¼šæˆªåœ– Console ä¸­çš„æ‰€æœ‰ç´…è‰²/é»ƒè‰²éŒ¯èª¤

3. **ç¶²è·¯ç’°å¢ƒ**ï¼š
   - æ˜¯å¦åœ¨å…¬å¸/æ ¡åœ’ç¶²ï¼Ÿ
   - æ˜¯å¦ä½¿ç”¨ä»£ç†æˆ– VPNï¼Ÿ
   - ä½¿ç”¨çš„é‹ç‡Ÿå•†ï¼Ÿ

---

## ğŸ“ å¸¸ç”¨å‘½ä»¤åƒè€ƒ

| åŠŸèƒ½ | å‘½ä»¤ |
|------|------|
| å®Œæ•´è¨ºæ–· | `diagnoseHttpConnection()` |
| å¿«é€Ÿæ¸¬è©¦ | `testHttpConnection()` |
| æŸ¥çœ‹é…ç½® | `console.log(httpConfig)` |
| æŸ¥çœ‹ç›®æ¨™ URL | `console.log(buildHttpUrl())` |
| æŸ¥çœ‹æœ€å¾Œå›æ‡‰ | `console.log(httpLastResponse)` |
| æ‰‹å‹•ç™¼é€è«‹æ±‚ | `sendHttpRequest()` |
| å•Ÿå‹•è¼ªè©¢ | `startHttpPolling()` |
| åœæ­¢è¼ªè©¢ | `stopHttpPolling()` |

---

## âœ… é©—è­‰ä¿®å¾©æˆåŠŸ

### æ¸¬è©¦æ–¹æ³• 1ï¼šä½¿ç”¨æŒ‰éˆ•
åœ¨é é¢ä¸Šé»æ“Šã€ŒğŸ”— æ¸¬è©¦ HTTP é€£ç·šã€æŒ‰éˆ•

### æ¸¬è©¦æ–¹æ³• 2ï¼šä½¿ç”¨å‘½ä»¤
åœ¨ Console åŸ·è¡Œï¼š
```javascript
await testHttpConnection()
```

### é æœŸçµæœ
```
âœ… HTTP é€£ç·šæ¸¬è©¦æˆåŠŸï¼
   æ•¸æ“šå·²æˆåŠŸè¿”å›
```

---

**ä¿®æ”¹æ™‚é–“**ï¼š2025-10-23
**é©ç”¨ç‰ˆæœ¬**ï¼šä¿®æ”¹å¾Œçš„ index.html
